[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Global Measles Emergency: Data Analysis",
    "section": "",
    "text": "In 2000, the U.S. declared measles eliminated.\nBy 2024, it was back.\n\n\n\n\nResurgence in Red\nMeasles, once nearing eradication, has resurged globally, with over 10.3 million cases and 107,500 deaths in 2023—mostly among young children. Europe saw its highest case count in 25 years in 2024, and the U.S. surpassed 1,000 cases by May 2025. This resurgence highlights the urgent need to restore high vaccination rates, as declining coverage and misinformation have weakened herd immunity.\n\n\nData\nFirst of all, let’s presented the libraries we used for this data analysis.\n\n\nShow code\nlibrary(tidyverse) # data wrangling\nlibrary(tidybayes) # predictions visualization\nlibrary(tibble) # modern reimagining of the data.frame\nlibrary(readr) # load .csv files\nlibrary(rmarkdown) # table display\nlibrary(sf) # data mapping\nlibrary(rnaturalearth) # data linkage for map plotting\nlibrary(rnaturalearthdata) # data linkage for map plotting\nlibrary(rnaturalearthhires) # county- and state-level USA data\nlibrary(tigris) # county-level data linkage\nlibrary(plotly) # data visualization interactivity\nlibrary(patchwork) # visualization customization\nlibrary(ggsci) # data visualization customization\nlibrary(brms) # Bayesian Generalized (non)-linear multivariate models\nlibrary(mall) # LLM integration\nlibrary(httr2) # pipeable API for working with web APIs by HTTP\nlibrary(jsonlite) # JSON parser and generator\n\n\nWhich data we are gonna use for this analysis?\n\nEurope data\nInputs from this dataset:\n\n33 regions\n6 types of indicators:\n\nAge standardised rate\nNotification rate\nNumber of deaths\nReported confirmed cases\nVaccination coverage (first dose)\nVaccination coverage (second dose)\n\n3 ways of expressing these indicators:\n\nRates are expressed in number of cases per 1 million\nEvents and cases are reported as counts\nCoverage is reported as percentage of people receiving one or two shots\n\nRange of time covers from 1999 up to 2023\n\n\n\n\n\n  \n\n\n\n\n\nGlobal data\nThis dataset contains data from 6 regions, and 194 countries from 2011 up to 2024.\n\n\n\n\n  \n\n\n\n\n\nGlobal data: MMR coverage\nThis dataset offers data from 6 different regions, and 164 countries from 2011 up to 2024.\n\n\n\n\n  \n\n\n\n\n\nUSA data\nData on measles cases in the USA from 1985 up to 2025.\n\n\n\n\n  \n\n\n\n\n\nUSA data: MMR coverage\nData on estimated percentage of children receiving the MMR vaccine by state (53 data points) and school year (from 2009-10 to 2023-2024).\n\n\n\n\n  \n\n\n\n\n\n\nObjectives\nThis study investigates the relationship between MMR vaccine uptake, measles incidence, and complications across time and regions, aiming to uncover the drivers behind vaccine coverage disparities and their public health impacts. Specifically, it analyzes trends in vaccination and case rates, compares outbreak dynamics in Europe and the U.S., identifies high-risk areas with low coverage, and explores the influence of social media on vaccine perceptions. The goal is to inform targeted, evidence-based strategies to increase MMR vaccination and prevent further measles resurgence.\n\n\nComparative analysis of measles case growth\nThrough a systematic approach for data sourcing and standardization, growth rates for Europe and the U.S. were compared. For Europe, we selected the age standardized rates for EU/EEA including UK until 2019.\n\n\n\n\n  \n\n\n\nUnfortunately, we had no data from 2019 onwards for Europe. For a global view of how these rates differed by country, we can create a map of Europe displaying the age standardized rates for each country by year.\n\n\n\n\n\n\nFor the U.S. to obtain comparable data was a bit tricky. Since we lacked age-specific measles case data for the U.S., we adjusted crude measles rates based on changes in the U.S. age distribution over time using historical data from the U.S. Census Bureau data bank. This approach approximate age standardization when age-specific case data is unavailable.\n\n\nShow code\n# first step: based on U.S Census historical data, add U.S. population for each year\nusa_data %&gt;%\n  \n  # filter by unique years (we identified that data from 2000 onwards were duplicated)\n  filter(!duplicated(year)) %&gt;%\n  \n  # ensure ordered time\n  arrange(year) %&gt;%\n  \n  mutate(US_pop = c(237.9, 240.1, 242.3, 244.5, 246.8,  \n                    249.6, 252.1, 254.9, 257.5, 260.3,\n                    263.0, 265.9, 268.8, 271.6, 274.9,\n                    281.4, 285.0, 288.6, 292.0, 295.5,\n                    298.4, 301.2, 304.1, 306.8, 309.3,\n                    311.6, 314.0, 316.5, 318.9, 321.4,\n                    324.1, 326.6, 329.0, 331.4, 333.3,\n                    335.9, 336.9, 338.3, 339.9, 341.4,\n                    342.8) * 1e6) %&gt;% # Population in millions\n  \n  # second step: crude rates calculation\n  mutate(crude_rate = (cases / US_pop) * 1e6) %&gt;%\n  \n  # third step: add age distribution proxies; we approximated the proportiong of the population in high-risk groups (e.g., children) over time using U.S. Census trends and the Census Buruea's Population Estimates Program (PEP)\n  mutate(prop_young = case_when(\n    year %in% 1985:1989 ~ 0.219,\n    year %in% 1990:1994 ~ 0.206,\n    year %in% 1995:1999 ~ 0.205,\n    year %in% 2000:2004 ~ 0.218,\n    year %in% 2005:2009 ~ 0.206,\n    year %in% 2010:2014 ~ 0.201,\n    year %in% 2015:2019 ~ 0.188,\n    TRUE ~ NA_real_\n  ),\n  \n  # fourth step: age-adjusted rate calculation\n  adj_rate = crude_rate / prop_young)\n\n\nThe resulted data frame:\n\n\n\n\n  \n\n\n\nNeat! We have now comparable data. However, we are interested in growth rates. Based on epidemiological evidence, one of the most straightforward ways of calculating disease growth rates is:\n\\(Growth Rate_{t2} = \\frac{Rate_{t2} - Rate_{t1}}{Rate_{t1}}\\)\nThe plain interpretation of this growth rate is how much the rate has increased or decreased relative to the previous year. After these calculations, we will visualize these estimates over time grouped by region of interest (Europe vs. the U.S.).\n\n\nShow code\neurope_comp %&gt;%\n  \n  # merge both datasets\n  rbind(usa_comp) %&gt;%\n  \n  # ensure the data is in the correct chronological order\n  arrange(RegionName, Time) %&gt;%\n  \n  # to compute growth rates within each region\n  group_by(RegionName) %&gt;%\n  \n  # calculates the growth rate using the formula\n  mutate(growth_rate = (NumValue - lag(NumValue)) / lag(NumValue)) %&gt;%\n  \n  # create variable indicating the time frame where the growth rate was observed\n  mutate(time_frame = paste0(lag(Time), \"-\", Time))\n\n\n\n\n\n\n  \n\n\n\n\n\n\n\n\n\nThis plot reveals several key epidemiological patterns: measles growth in Europe and the U.S. follows cyclical, outbreak-driven trends, with Europe showing sharp spikes in 2009–2010 and 2016–2017. While the regions occasionally align, they often diverge, reflecting differing local factors. The U.S. saw a sustained rise in cases from 2011–2014, contrasting with Europe’s volatility. Periods of negative growth suggest effective control or natural decline in outbreaks. Notably, from 2017–2019, U.S. cases rose again—likely tied to increasing vaccine hesitancy—while Europe’s rates declined, possibly due to more successful interventions. Overall, the trends underscore the impact of vaccination coverage and public health responses.\n\n\nPinpointing peril: where are the at-risk regions?\nOur quest to identify at-risk regions begins in Europe, where we wield the twin lenses of first-dose (MCV1) and second-dose (MCV2) MMR vaccination coverage to reveal pockets of vulnerability.\nOur journey begins with a global lens, assessing measles vaccination coverage across countries to identify regions where immunity is weakening and outbreaks loom. Armed with data on first-dose (MCV1) and second-dose (MCV2) MMR coverage, we classify risk setting up a risk scoring system grounded in epidemiological evidence.\n\\(Risk = (1- \\frac{MCV1}{100})*0.6+(1-\\frac{MCV2}{100})*0.4\\)\nMCV1 was weighted more heavily, as it captures the bulk of immunization impact. The interpretation for this risk score would be that scores near 0 means low risk, and scores near 1 means high risk.\n\n\n\n\n\n\nFor a tabular vision of these data, we can extract the 10 most at-risk countries by year based on our generated risk score.\n\n\n\n\n  \n\n\n\nFor instance, in 2015 the 10 most at-risk countries globally were Malawi (risk score = 0.452), Kenya, Ukraine, Angola, Niger, Lesotho, Paraguay, Yemen, Syrian Arab Republic, and Indonesia (risk score = 0.323), respectively.\nTurning our focus to the U.S., we refine our analysis to the state level, where policy decisions and healthcare access create stark disparities in vaccine coverage. Since U.S. data often provides aggregate MMR estimates in children population rather than dose metrics, we adapted our approach plotting the estimated coverage percentage by county and year.\n\n\nShow code\n### STATE_LEVEL (our usa_cov data is at this level)\n# Get U.S. states data with FIPS codes\nstates_data &lt;- ne_states(country = \"United States of America\", returnclass = \"sf\") %&gt;%\n  filter(iso_a2 == \"US\") %&gt;%  # Filter for only U.S. states\n  select(\n    state = name,           # Full state name\n    state_abbr = postal,     # State abbreviation\n    fips = fips             # State FIPS code\n  ) %&gt;%\n  st_drop_geometry() %&gt;%    # Remove geometry column\n  arrange(state)            # Sort alphabetically\n\n# data join\nstates_df &lt;- states_data %&gt;%\n  left_join(usa_cov, by = c(\"state\" = \"geography\")) %&gt;%\n  mutate(estimate_pct = as.numeric(sub(\"%\", \"\", estimate_pct))) %&gt;%\n  filter(!is.na(estimate_pct))\n\n\n# function to create data visualizations\ncreate_us_vaccine_coverage_map &lt;- function(data) {\n  \n  # Check required columns\n  if (!all(c(\"state_abbr\", \"state\", \"school_year\", \"estimate_pct\") %in% colnames(as.data.frame(data)))) {\n    stop(\"Required columns missing. Need: state_abbr, state, school_year, estimate_pct\")\n  }\n\n  # Ensure school_year is character\n  data$school_year &lt;- as.character(data$school_year)\n\n  # Convert sf object if needed\n  if (inherits(data, \"sf\")) {\n    coords_data &lt;- st_centroid(data %&gt;% filter(!is.na(school_year))) %&gt;%\n      st_coordinates() %&gt;%\n      as.data.frame()\n\n    plot_data &lt;- cbind(\n      as.data.frame(data) %&gt;%\n        filter(!is.na(school_year)) %&gt;%\n        select(-geometry),\n      coords_data\n    )\n  } else {\n    plot_data &lt;- data %&gt;% filter(!is.na(school_year))\n  }\n\n  # Sort school years\n  school_years &lt;- unique(plot_data$school_year)\n  first_years &lt;- as.numeric(substr(school_years, 1, 4))\n  school_years &lt;- school_years[order(first_years)]\n\n  # Create base plot\n  p &lt;- plot_ly()\n\n  # Add each year's data as a trace\n  for (i in seq_along(school_years)) {\n    yr &lt;- school_years[i]\n    yr_data &lt;- plot_data %&gt;% filter(school_year == yr)\n\n    trace &lt;- list(\n      type = \"choropleth\",\n      locationmode = \"USA-states\",\n      locations = yr_data$state_abbr,\n      z = yr_data$estimate_pct,\n      text = paste0(\n        \"&lt;b&gt;\", yr_data$state, \"&lt;/b&gt;\",\n        \"&lt;br&gt;Vaccination Coverage: &lt;b&gt;\", round(yr_data$estimate_pct, 1), \"%&lt;/b&gt;\",\n        \"&lt;br&gt;School Year: \", yr_data$school_year\n      ),\n      colorscale = \"Viridis\",\n      reversescale = FALSE,\n      zmin = min(plot_data$estimate_pct, na.rm = TRUE),\n      zmax = 100,\n      colorbar = list(\n        title = \"Vaccination&lt;br&gt;Coverage (%)\",\n        thickness = 15,\n        len = 0.5,\n        y = 0.5\n      ),\n      marker = list(line = list(color = 'rgb(180,180,180)', width = 0.3)),\n      hoverinfo = \"text\",\n      visible = ifelse(i == length(school_years), TRUE, FALSE),\n      name = yr\n    )\n\n    # Add the trace using do.call\n    p &lt;- do.call(add_trace, c(list(p), trace))\n  }\n\n  # Dropdown menu for year selection\n  year_buttons &lt;- lapply(seq_along(school_years), function(i) {\n    visible_vec &lt;- rep(FALSE, length(school_years))\n    visible_vec[i] &lt;- TRUE\n\n    list(\n      method = \"update\",\n      args = list(\n        list(visible = visible_vec),\n        list(title = paste0(\"&lt;b&gt;Vaccine Coverage by State in School Year \", school_years[i], \"&lt;/b&gt;\"))\n      ),\n      label = school_years[i]\n    )\n  })\n\n  # Final layout\n  p &lt;- p %&gt;%\n    layout(\n      title = list(\n        text = paste0(\"&lt;b&gt;Vaccine Coverage by State in School Year \", school_years[length(school_years)], \"&lt;/b&gt;\"),\n        font = list(family = \"Arial\", size = 18)\n      ),\n      geo = list(\n        scope = \"usa\",\n        projection = list(type = 'albers usa'),\n        showcoastlines = TRUE,\n        coastlinecolor = \"rgb(150,150,150)\",\n        showland = TRUE,\n        landcolor = \"rgb(250,250,250)\",\n        showframe = FALSE,\n        framecolor = \"rgb(200,200,200)\",\n        showlakes = TRUE,\n        lakecolor = \"rgb(230,245,255)\",\n        showsubunits = TRUE,\n        subunitcolor = \"rgb(150,150,150)\",\n        subunitwidth = 0.5\n      ),\n      updatemenus = list(list(\n        type = \"dropdown\",\n        active = length(school_years) - 1,\n        buttons = year_buttons,\n        x = 0.15,\n        y = 0.9,\n        bgcolor = \"#ffffff\",\n        bordercolor = \"#666666\",\n        font = list(size = 12)\n      )),\n      annotations = list(\n        list(\n          text = \"&lt;b&gt;Select School Year:&lt;/b&gt;\",\n          x = 0.03, y = 0.95, xref = \"paper\", yref = \"paper\",\n          showarrow = FALSE, font = list(size = 12, family = \"Arial\")\n        ),\n        list(\n          text = \"Source: CDC Vaccination Data\",\n          x = 0.9, y = 0.02, xref = \"paper\", yref = \"paper\",\n          showarrow = FALSE,\n          font = list(size = 10, color = \"gray60\", family = \"Arial\"),\n          align = \"right\"\n        )\n      ),\n      margin = list(l = 20, r = 20, t = 50, b = 20),\n      hoverlabel = list(\n        bgcolor = \"white\",\n        font = list(family = \"Arial\", size = 12, color = \"black\"),\n        bordercolor = \"gray80\"\n      )\n    ) %&gt;%\n    config(\n      displayModeBar = TRUE,\n      scrollZoom = TRUE,\n      modeBarButtonsToRemove = list(\n        'sendDataToCloud', 'autoScale2d', 'resetScale2d',\n        'hoverClosestCartesian', 'hoverCompareCartesian',\n        'select2d', 'lasso2d'\n      ),\n      toImageButtonOptions = list(\n        format = \"png\",\n        filename = \"vaccine_coverage_map\",\n        height = 1000,\n        width = 1400,\n        scale = 2\n      )\n    )\n\n  return(p)\n}\n\n# plot!\ncreate_us_vaccine_coverage_map(states_df)\n\n\n\n\n\n\nRecent reports from state health departments and national outlets (e.g., CDC, or The Washington Post) show that measles cases in 2025 are concentrated in U.S. states with historically low vaccination coverage. This reinforces the strong link between immunization gaps and outbreak risk. States like Alaska, California, Georgia, and Texas—each facing challenges such as rural access issues, exemption clusters, rising nonmedical exemptions, or vaccine hesitancy—had MMR coverage below the 95% threshold before 2025, placing them in the high-risk category identified in earlier analyses.\n\n\n\n\n  \n\n\n\n\n\nTime’s tale: how vaccination rates have evolved\nThis section examines how vaccination rates have evolved over time. Due to the lack of directly available national data for the U.S., we estimated coverage using a population-weighted average of state-level figures. For global analysis, only complete records for MCV1, MCV2, and measles case counts were included, without imputation. The final dataset combines these global records with the U.S. national estimates.\n\n\nShow code\n# U.S. national coverage data\nstates_df %&gt;% \n  \n  # group by year\n  group_by(school_year) %&gt;% \n  \n  # add up the population-weighted average\n  summarise(average_w = sum(estimate_pct * population_size, na.rm = TRUE) / sum(population_size, na.rm = TRUE)) %&gt;%\n  \n  # create USA country \n  mutate(Country = \"USA\",\n         \n         # adjusting year to the second school year\n         school_year = as.numeric(substr(school_year, 1, 4)) + 1) %&gt;%\n  \n  # data customization\n  rename(Year = school_year,\n         antigen_MCV1 = average_w) %&gt;%\n  select(Country, Year, antigen_MCV1) %&gt;%\n  \n  # join measles cases data\n  left_join(usa_data %&gt;% select(year, cases),\n            by = c(\"Year\" = \"year\")) %&gt;%\n  \n  # remove duplicate years\n  filter(!duplicated(Year)) \n\n\n\n\n\n\n  \n\n\n\nNow, we join U.S. national data with global data.\n\n\nShow code\n# final data set including country, year, first-dose MMR coverage, second-dose MMR coverage and number of cases\n\n# keep only complete cases\nglobal_data[complete.cases(global_data), ] %&gt;%\n  \n  # calculation of total number of yearly cases\n  mutate(cases = rowSums(global_data[complete.cases(global_data), c(\"January\", \"February\", \"March\", \"April\", \n                           \"May\", \"June\", \"July\", \"August\", \n                           \"September\", \"October\", \"November\", \"December\")], \n                    na.rm = TRUE)) %&gt;%\n  select(Country, Year, cases) %&gt;%\n  \n  # join to the previous width-format dataset\n  left_join(global_risk, by = c(\"Country\", \"Year\")) %&gt;%\n  \n  # join U.S. national data\n  full_join(usa_cov_national) %&gt;%\n  \n  # create a new variable centering the year for modelling efficiency\n  mutate(year_cen = Year - min(Year)) %&gt;%\n  select(Country, Year, year_cen, antigen_MCV1, antigen_MCV2, cases)\n\n\n\n\n\n\n  \n\n\n\nTo ensure model convergence and robust global representation, we applied the following refinements:\n\nPrioritized high-impact countries: focused on nations with high disease burden, recent outbreaks, or strategic importance in global immunization efforts to improve model generalizability.\nOutlier exclusion: removed countries reporting case counts above the 98th percentile to prevent overdispersion in posterior estimates.\n\n\n\nShow code\n# countries' selection\nselected_countries &lt;- c(\n  # Africa\n  \"Nigeria\",\n  \"Democratic Republic of the Congo\",\n  \"Ethiopia\",\n  \"Kenya\",\n  \"South Africa\",\n  \n  # America\n  \"Brazil\",\n  \"USA\",\n  \"Mexico\",\n  \"Cuba\",\n  \"Argentina\",\n  \n  # Asia\n  \"India\",\n  \"Pakistan\",\n  \"Bangladesh\",\n  \"Indonesia\",\n  \"China\",\n  \n  # Europe\n  \"Ukraine\",\n  \"Romania\",\n  \"France\",\n  \"United Kingdom of Great Britain and Northern Ireland\",\n  \"Germany\",\n  \n  # Oceania\n  \"Papua New Guinea\",\n  \"Australia\",\n  \"Fiji\",\n  \"New Zealand\",\n  \"Philippines\"\n)\n\n# outliers detection and remove\noutlier_threshold &lt;- as.numeric(quantile(model_data %&gt;% filter(!is.na(cases)) %&gt;% .$cases, probs = 0.98))\n\n\n# final dataset used for modelling\nmodel_data &lt;- model_data %&gt;%\n  \n  # countries selection\n  filter(Country %in% selected_countries) %&gt;%\n  \n  # outlier threshold application\n  filter(cases &lt; outlier_threshold)\n\n\nGreat. After, initial examination revealed that the distribution of MCV1 and MCV2 coverage were approximately normally distributed, supporting the use of parametric modelling approaches.\nTo analyse these coverage trends over time, we employed a Bayesian GLM with hierarchical structure to account for year-specific effects (temporal trends) and heterogeneity across countries (country-specific random slopes and intercepts). This approach allowed us to (1) estimate vaccination coverage trends while adjusting for between-country variability, and (2) incorporate uncertainty in a main principled manner through posterior distributions.\n\n\nShow code\n### COVERAGE MODEL OVER TIME\n# model with multilevel terms (this model showed better model fit parameters than simplier models)\nmodel_cov_multi &lt;- brm(bf(antigen_MCV1 ~ year_cen + (1 | year_cen) + (1 + year_cen | Country)),\n                          data = model_data,\n                          family = gaussian(),\n                          chains = 4,\n                          iter = 2000,\n                          seed = 1234)\n\n\nNext, we have to check if the model reached the convergence. One simple way of checking this is by plotting the trace plots for each model parameter (i.e., great overlapping of the chains mean that model has converged), and by visualizing posterior predictive draws vs. observed data points.\n\n\nShow code\n# posterior checks\npp_check(model_cov_multi, ndraws = 100)\n\n\n\n\n\nPredicted responses followed similar patterns than observed data, which is a good signal for estimating robust posterior predictions.\nThe parameter of interest here is ^b_year_cen which represents the beta coefficient of the time in our model; i.e., how much % of MCV1 coverage increases or decreases by +1 year. Let’s extract 4,000 random draws of this model parameter and plot them to observe its distribution.\n\n\nShow code\n# extract random draws from our model\ndraws &lt;- posterior_samples(model_cov_multi,\n                           pars = \"b_year_cen\")\n\n# plot!\nggplot(aes(x = b_year_cen), data = draws) +\n  geom_vline(xintercept = 0, linetype = 2, col = \"gray20\", alpha = .8) +\n  geom_density(fill = \"lightblue\", col = \"lightblue\", alpha = 0.6) + \n  geom_point(y = 0, x = mean(draws$b_year_cen),\n             size = 3) +\n  labs(x = expression(beta~\"coefficient of year\"),\n       y = \"Density\") +\n  theme_minimal()\n\n\n\n\n\nAlthough the distribution includes zero, it is predominantly skewed toward negative values. This suggests that as time progresses—reflected by the inclusion of additional years in the regression model—the trend is generally downward, indicating a decline in vaccination coverage over time.\nThe fact that Bayesian methods create an actual sampling distribution for our parameters of interest means that we can calculate the exact probabilities that this coefficient would be smaller than 0, indicating a negative trend towards vaccination over time. This can be done by looking at the empirical cumulative distribution function (ECDF). This function lets us select one specific value X, and returns the probability of some value x being smaller than X based on provided data.\n\n\nShow code\n# create the ECDF\nyear.ecdf &lt;- ecdf(draws$b_year_cen)\n\n# calculate probabilities for values smaller than 0\nyear.ecdf(0)\n\n\n[1] 0.89825\n\n\nWith roughly 90%, the probability of our values for this parameter being smaller than 0 is high, suggesting an overall negative vaccination trend over time.\nIn addition, we can predict the MCV1 coverage for specific countries from this model.\n\n\n\n\n\nFor example, for Bangladesh we can observe just not that has kept MCV1 vaccination coverage above 95%, but also presents an increased trend towards vaccination. Conversely, the opposite was observed for countries like Brazil, Papua New Guinea, and Romania.\n\n\nFuture’s forecast: projecting measles cases by 2026\nAccurately predicting the number of cases for a highly contagious disease like measles is fraught with challenges, as incidence hinges on a complex interplay of demographic, environmental, and behavioral factors—many of which are volatile or context-dependent. Nevertheless, leveraging observed historical data, we developed a robust statistical approach to project measles cases for 2026, prioritizing transparency in uncertainty.\nUsing a Bayesian hurdle negative binomial model, we accounted for the unique distribution of our outcome (count data with a relatively high number of zero cases). This framework combines two components:\n\nThe non-zero part (mu): A negative binomial model predicting case counts where measles occurs.\nThe zero part (hu): A logistic regression estimating the probability of observing zero cases in a given year and country.\n\n\n\nShow code\n# model with multilevel terms\nmodel_cases_multi &lt;- brm(bf(cases ~ year_cen + (1 | year_cen) + (1 + year_cen | Country),\n                             hu ~ year_cen),\n                          data = model_data,\n                          family = hurdle_negbinomial(),\n                          chains = 4,\n                          iter = 2000,\n                          seed = 1234)\n\n\n\n\nShow code\n## logged posterior predictions\npred &lt;- posterior_predict(model_cases_multi)\n\n## plot predicted vs. observed data \nbayesplot::ppc_dens_overlay(y = log1p(model_data %&gt;% filter(!is.na(cases)) %&gt;% .$cases),\n                            yrep = log1p(pred[1:10, ]))\n\n\n\n\n\nAfter validating that the model captured observed trends, conditional effects for the hu part of our model were extracted; and therefore, that allowed us to visualize the probabilities of seeing 0 cases over the years globally.\n\n\nShow code\n# conditional effects\ncond_effects &lt;- conditional_effects(model_cases_multi,\n                    dpar = \"hu\") \n\n# plot!\ncond_effects$year_cen %&gt;%\n  ggplot(aes(x = year_cen + 2010, y = estimate__)) +\n  geom_lineribbon(aes(ymax = upper__,\n                      ymin = lower__),\n                  alpha = .6, fill = \"steelblue\") +\n  labs(x = \"Year\",\n       y = \"Predicted probability of seeing 0 measles cases\") +\n  theme_bw() +\n  scale_x_continuous(breaks = seq(2010, 2026, 2)) +\n  scale_y_continuous(labels = scales::label_percent())\n\n\n\n\n\nOver time, the rising likelihood of zero cases reflects progress in measles containment efforts worldwide.\nNext, we generated projections for the focal countries. Our results, presented below, reflect both median predictions and 95% Credible Intervals (95% CrI) to underscore the inherent uncertainty in forecasting infectious disease dynamics.\n\n\nShow code\n# data frame of predictions for 2026\ntable_df &lt;- model_cases_multi %&gt;%\n  predictions(newdata = datagrid(year_cen = 16,\n                                 Country = unique(model_data$Country)), \n              # allow new levels (2026)\n              allow_new_levels = TRUE) %&gt;% as.data.frame() %&gt;%\n  mutate_if(is.numeric, round, 0) %&gt;%\n  select(Country, estimate, conf.low, conf.high) %&gt;%\n  rename(`Predicted cases` = estimate,\n         `Lower bound (95% CrI)` = conf.low,\n         `Upper bound (95% CrI)` = conf.high) %&gt;%\n  arrange(Country)\n\n# Granular color variation\nquantiles &lt;- quantile(table_df$`Predicted cases`, probs = c(0.25, 0.5, 0.75))\n\n# table\nDT::datatable(table_df) %&gt;%\n  formatStyle(\n    'Predicted cases',\n    backgroundColor = styleInterval(\n      quantiles, \n      c('#FFCCCB', '#FF9999', '#FF6666', '#CC0000')  # Light to dark red gradient\n    ),\n    color = styleInterval(\n      quantiles[1:2], \n      c('black', 'black', 'white')\n    )\n  )\n\n\n\n\n\n\n\nEstimates had associated large uncertainty as we expected.\nFor the sake of file size control, we cannot present here our model with MCV1 and MCV2 coverage as predictors. However, while MCV1 coverage showed no significant association with reduced case counts over time, MCV2 coverage emerged as a critical protective factor—highlighting the importance of second-dose vaccination campaigns in outbreak mitigation.\n\n\nDigital echoes: social media’s sway on vaccine views\nThe rise of social media has transformed public discourse around vaccination, amplifying both evidence-based advocacy and vaccine hesitancy. To quantify these dynamics, we extracted public posts discussing vaccines—including vaccine, COVID-19, and measles—from Reddit via its API. For each subreddit topic we extracted 100 random posts.\n\n\nShow code\n# query Reddit's search endpoint\nsearch_url &lt;- \"https://oauth.reddit.com/r/Measles/search\" #also scrapped r/Vaccines and r/COVID19\n\n# proceed with the request\nreq &lt;- request(search_url) %&gt;%\n  req_headers(\n    \"Authorization\" = paste(\"bearer\", access_token),\n    \"User-Agent\" = \"reddit-covid-vaccine-research/0.1\"\n  ) %&gt;%\n  req_url_query(\n    q = \"measles vaccine\", # also \"COVID-19\" and \"vaccines\"\n    sort = \"old\",\n    limit = 100\n  ) %&gt;%\n  req_perform()\n\n# parse results\nresults &lt;- resp_body_json(req)$data$children\n\n# extract and normalize data\nposts_df &lt;- purrr::map_dfr(results, function(post) {\n  data &lt;- post$data\n  \n  tibble(\n    title = data$title %||% NA_character_,\n    selftext = data$selftext %||% NA_character_,\n    score = data$score %||% NA_integer_,\n    author = data$author %||% NA_character_,\n    created_utc = data$created_utc %||% NA_real_,\n    permalink = data$permalink %||% NA_character_\n  )\n}) %&gt;%\n  mutate(\n    created = as.POSIXct(created_utc, origin = \"1970-01-01\", tz = \"UTC\"),\n    url = paste0(\"https://reddit.com\", permalink)\n  ) %&gt;%\n  mutate(created = as.Date.POSIXct(created))\n\n\nThe resulted output looks like this:\n\n\n\n\n  \n\n\n\nUsing Large Language Models (LLMs) such as Llama 3.2, we classified each post (title and body text) into three categories: pro-vaccine, vaccine-hesitant, or neutral, enabling a data-driven analysis of sentiment trends over time. For vaccines, and COVID-19, we focus on the body text of the post since we have more available data points. For measles vaccine, we used the title of the post for sentiment classification. At the end of this process, 136 posts were analysed.\n\n\nShow code\n# prompt specification for LLM call\nprompt &lt;- paste0(\n  \"Answer a question.\",\n  \"Return only the answer, no explanation\",\n  \"Acceptable answers are 'Pro-vaccine', 'Vaccine-hesitant', or 'Neutral'.\",\n  \"Answer this about the following text, is this user in favour of vaccines?\"\n)\n\n# LLM backend use specification\nllm_use(\"ollama\", \"llama3.2:latest\", seed = 100, .silent = TRUE)\n\n# new dataset with the LLM predictions incorporated\nnew_posts_df &lt;- posts_df %&gt;%\n  \n  # ensure we have data\n  mutate(title = ifelse(title %in% c(\"\", \"\\n\"), NA, title)) %&gt;%\n  filter(!is.na(title)) %&gt;%\n  \n  # LLM call\n  llm_custom(title, prompt = prompt)\n\n\nAfter merging all the new data sets for each search term, we can visualize the temporal trends towards vaccination in social media content. Additionally, we added key U.S. government policy and administration changes to the timeline, since these transitions can provide important context alongside the vaccines’ perception and COVID-19 events.\n\n\nShow code\n# save our data for the posterior plot\ntimeline_plot &lt;- sm_data %&gt;%\n  \n  # format posts' dates\n  mutate(month = format(created, \"%Y-%m\")) %&gt;%\n  \n  # calculate the number of pro-vaccine, vaccine-hesitant and neutral posts by date\n  group_by(month, .pred) %&gt;%\n  summarise(n = n()) %&gt;%\n  ungroup() %&gt;%\n  mutate(month = ym(month))\n\n\n# create a data frame with key events\nkey_events &lt;- data.frame(\n  date = lubridate::ymd(c(\n    \"2020-11-07\", # Biden election called\n    \"2020-12-11\", # FDA EUA for Pfizer\n    \"2020-12-18\", # FDA EUA for Moderna\n    \"2021-01-20\", # Biden Inauguration\n    \"2021-02-27\", # J&J Vaccine EUA\n    \"2021-07-01\", # Delta variant becomes dominant\n    \"2021-08-23\", # Pfizer receives full FDA approval\n    \"2021-11-19\", # Boosters approved for all adults\n    \"2021-12-01\", # Omicron variant identified in US\n    \"2022-09-18\", # Biden declares \"pandemic is over\"\n    \"2023-05-11\",  # COVID emergency officially ends\n    \"2025-01-20\"  # Trump Inauguration\n  )),\n  event = c(\n    \"Biden election called\",\n    \"FDA EUA for Pfizer\",\n    \"FDA EUA for Moderna\",\n    \"Biden Inauguration\",\n    \"J&J Vaccine EUA\",\n    \"Delta dominant\",\n    \"Pfizer full approval\",\n    \"Boosters for adults\",\n    \"Omicron in US\",\n    \"Biden: \\\"pandemic is over\\\"\",\n    \"COVID emergency ends\",\n    \"Trump Inauguration\"\n  ),\n  y_position = c(100, 50, 70, 110, 35, 80, 40, 60, 55, 105, 85, 70),  # Adjust based on your data range\n  event_type = c(\n    \"Political\", \"Medical\", \"Medical\", \"Political\", \"Medical\", \"Variant\", \"Medical\", \"Medical\", \"Variant\", \"Political\", \"Political\", \"Political\"\n  )\n)\n\n\n# convert dates to first of month for plotting\nkey_events$month &lt;- floor_date(key_events$date, \"month\")\n\n\n# plot\nggplot() +\n  \n  # add softer y-axis grid lines\n  geom_hline(yintercept = seq(0, 30, 5), \n             color = \"gray95\", linewidth = 0.3)+\n  \n  # plot the sentiment lines\n  geom_line(data = timeline_plot, \n            aes(x = month, y = n, color = .pred, group = .pred),\n            size = 1.2) +\n  geom_point(data = timeline_plot, \n             aes(x = month, y = n, color = .pred, size = n),\n             alpha = 0.7) +\n  \n  # add event markers with different colors by type\n  geom_vline(data = key_events, \n             aes(xintercept = as.numeric(month), color = event_type),\n             linetype = \"dashed\", alpha = 0.7) +\n  \n  # add event labels with color coding\n  geom_label_repel(data = key_events,\n                  aes(x = month, y = y_position, \n                      label = event, \n                      fill = event_type),\n                  box.padding = 0.5,\n                  point.padding = 0.3,\n                  force = 10,\n                  segment.color = \"darkgray\",\n                  color = \"white\",\n                  size = 3,\n                  alpha = 0.9) +\n  \n  # customize appearance\n  scale_color_manual(values = c(\"Pro-vaccine\" = \"#1b9e77\", \n                                \"Neutral\" = \"#7570b3\", \n                                \"Vaccine-hesitant\" = \"#d95f02\",\n                                \"Political\" = \"#e41a1c\",\n                                \"Medical\" = \"#377eb8\",\n                                \"Variant\" = \"#ff7f00\"),\n                     name = \"Sentiment/Event type\") +\n  scale_fill_manual(values = c(\"Political\" = \"#e41a1c\",\n                               \"Medical\" = \"#377eb8\",\n                               \"Variant\" = \"#ff7f00\"),\n                    name = \"Event Type\") +\n  scale_size(range = c(2, 8), guide = \"none\") +\n  scale_x_date(date_breaks = \"6 months\", \n               date_labels = \"%b\\n%Y\",\n               expand = expansion(mult = c(0.02, 0.08))) +\n  scale_y_continuous(breaks = seq(0, 30, 5)) +\n  \n  # add informative labels\n  labs(title = \"Vaccine Sentiment on Social Media Over Time\",\n       subtitle = \"With key COVID-19, vaccine-related events and U.S. political changes\",\n       x = \"\",\n       y = \"Number of Reddit posts (136 posts extracted)\") +\n  \n  # theme customization\n  theme_minimal() +\n  theme(\n    plot.title = element_text(face = \"bold\", size = 16),\n    plot.subtitle = element_text(size = 12, color = \"darkgray\"),\n    legend.position = \"bottom\",\n    legend.title = element_text(face = \"bold\"),\n    legend.box = \"vertical\",\n    panel.grid.minor = element_blank(),\n    panel.grid.major.x = element_blank(),\n    panel.grid.major.y = element_line(color = \"gray90\", linewidth = 0.3),\n    axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1),\n    axis.line.x = element_line(color = \"gray50\", linewidth = 0.5),\n    axis.title.y = element_text(hjust = 0),\n    axis.ticks.x = element_line(color = \"gray50\", linewidth = 0.5),\n    axis.ticks.length.x = unit(3, \"pt\"),\n    plot.margin = margin(t = 20, r = 20, b = 20, l = 20))\n\n\n\n\n\nTaking into consideration potential limitations (e.g., 136 posts do not definitely represent broader public opinion), we can observe that vaccine discussion remained minimal until a dramatic spike in late 2024/early 2025, where vaccine-hesitant sentiment shows the largest increase. Pro-vaccine sentiment shows a smaller reactive increase.\nHowever, the data suggests vaccine discourse is more strongly influenced by political leadership changes than by medical or scientific announcements, which may be a cause of concern.\nFinally, our dataset includes an engagement score for each post, calculated as the difference between likes (upvotes) and dislikes (downvotes). Notably, among the top 5 highest-scored posts, three were classified as vaccine-hesitant, with the two most highly engaged posts also falling into this category.\nBelow is the breakdown of the top-performing posts by score and sentiment classification:\n\n\n\n\n  \n\n\n\nThis trend suggests that vaccine-hesitant content generates disproportionately high engagement, potentially reflecting either algorithmic amplification or strong audience polarization. Further analysis could explore whether these patterns correlate with regional vaccination rates or misinformation prevalence."
  },
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "About Me",
    "section": "",
    "text": "Daniel Gallardo, PhD - Senior Consultant; Health Economics and Epidemiology; Insights, Evidence & Value Division, ICON plc."
  },
  {
    "objectID": "about.html#hi-there-im-daniel-gallardo",
    "href": "about.html#hi-there-im-daniel-gallardo",
    "title": "About Me",
    "section": "Hi there! I’m Daniel Gallardo 👋",
    "text": "Hi there! I’m Daniel Gallardo 👋\nI’m a data scientist passionate about epidemiology, statistical modeling, and public health analytics. I use R, Quarto, and GitHub to tell compelling data stories that drive real-world impact.\n\n📫 Contact Me\n\n📧 Gmail\n💻 GitHub\n🔗 LinkedIn"
  },
  {
    "objectID": "about.html#skills",
    "href": "about.html#skills",
    "title": "About Me",
    "section": "🧠 Skills",
    "text": "🧠 Skills\n\nR & R Markdown / Quarto\nEpidemiological modeling\nData visualization (ggplot2, plotly)\nGit/GitHub workflows\nReproducible research"
  },
  {
    "objectID": "about.html#interests",
    "href": "about.html#interests",
    "title": "About Me",
    "section": "🎯 Interests",
    "text": "🎯 Interests\n\nInfectious disease dynamics\nBayesian statistics\nOpen science & data sharing\nScience communication"
  }
]